---
emoji: headers/topring-chapter1.png
title: 'âœ¨ğŸŒˆğŸ’«í…ŒìŠ¤íŠ¸ğŸ’«ğŸŒˆâœ¨ (í† ë¹„ì˜ ìŠ¤í”„ë§)'
date: '2022-09-18 13:20:00'
author: ì¨ë¨¸
tags: Spring
categories: Spring
---

í•´ë‹¹ í¬ìŠ¤íŒ…ì€ [í† ë¹„ì˜ ìŠ¤í”„ë§ 3.1](https://search.shopping.naver.com/book/catalog/32463364883?cat_id=50010881&frm=PBOKPRO&query=%ED%86%A0%EB%B9%84%EC%9D%98+%EC%8A%A4%ED%94%84%EB%A7%81&NaPm=ct%3Dl7xcl9rk%7Cci%3D2beb40c880925062f67b8f4c293f36caed990219%7Ctr%3Dboknx%7Csn%3D95694%7Chk%3De46d0a257b549c8d320d7074983959664f253dd5)ì„ ì½ê³  ì±… ë‚´ìš©ê³¼ ì‹¤ìŠµ ì½”ë“œ ì •ë¦¬ ë° ìŠ¤í„°ë””ì—ì„œ ë‚˜ì˜¨ ì˜ê²¬ì„ ì •ë¦¬í•œ í¬ìŠ¤íŒ…ì´ë‹¤.  

## 2ì¥ í…ŒìŠ¤íŠ¸  

ìŠ¤í”„ë§ì„ êµ­ë¹„í•™ì›ì—ì„œ ì²˜ìŒ ë°°ìš´ ë‚˜ëŠ” `í…ŒìŠ¤íŠ¸`ê°€ ì¡´ì¬í•˜ëŠ” ì¤„ë„ ëª°ëë‹¤. 
ìì˜í•œ ì½”ë“œ í•˜ë‚˜ ê³ ì¹˜ëŠ” ë°ë„ ëŒ€ì†Œë™ì´ ì¼ì–´ë‚¬ë‹¤. 
íšŒì›ê°€ì… ê¸°ëŠ¥ì„ ë§Œë“œëŠ”ë° ë¹„ë°€ë²ˆí˜¸ ì œí•œì´ ì˜ ì•ˆë˜ëŠ” ê²ƒ ê°™ë‹¤ë©´  

- ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí•œë‹¤  
- ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê³  break pointë¥¼ ê±¸ê±°ë‚˜ ì¶œë ¥ë¬¸ì„ ì¨ë‘”ë‹¤     
- ë‹¤ì‹œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í‚¨ë‹¤  
- í¬ë¡¬ ì‹œí¬ë¦¿ + ê°•ë ¥ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ í˜ì´ì§€ì— ë“¤ì–´ê°„ë‹¤  
- íšŒì›ê°€ì…ì„ ì‹œë„í•˜ê³  ë‹¤ì‹œ í™•ì¸í•œë‹¤  

ì´ëŸ° ê³¼ì •ì„ ê±°ì³ì•¼ í–ˆë‹¤.  

í…ŒìŠ¤íŠ¸ê°€ ì¼ìƒì´ ëœ ì§€ê¸ˆì€ í…ŒìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ë¶ˆì•ˆí•˜ë‹¤. (ë ˆë²¨4 ë¯¸ì…˜ì„ í•˜ë©´ì„œ ì†Œí™€í•´ì§€ê¸´ í–ˆì§€ë§Œ...) 
í…ŒìŠ¤íŠ¸ë¥¼ ë°°ìš´ ì²˜ìŒì—” ì‹ ê¸°í–ˆê³ , ê·¸ ë‹¤ìŒì—” ì¡°ê¸ˆ ê·€ì°®ì•˜ëŠ”ë°, ì§€ê¸ˆì€ í…ŒìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ ì¤„ ì—†ì´ ë²ˆì§€ì í”„í•˜ëŠ” ê¸°ë¶„ì´ ë“ ë‹¤. 
í…ŒìŠ¤íŠ¸ëŠ” ë‚˜ì—ê²Œ ììœ ë¡­ê³  ì¬ë°Œê²Œ ì½”ë“œë¥¼ ê°–ê³  ë†€ê²Œ í•´ì£¼ëŠ” ì•ˆì „ì¥ì¹˜ì¸ ì…ˆì´ë‹¤.  

![ì¤ì¤ ì „ì²´ í…ŒìŠ¤íŠ¸](pickpick_test.png)
<div style="text-align:center; font-style:italic; color:grey;">
  í˜„ì¬ ê°œë°œì¤‘ì¸ ì¤ì¤ì˜ ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì½˜ì†” í™”ë©´. í¸-ì•ˆí•˜ë‹¤.  
</div>

<br>

## ì´ˆë‚œê° UserDaoTest ê°œì„ ê¸°  

1ì¥ì—ì„œ ë§Œë“¤ì—ˆë˜ `UserDaoTest`ëŠ” ë‚´ê°€ ì˜ˆì „ì— í–ˆë˜ íœ´ë¨¼-í…ŒìŠ¤íŠ¸ë³´ë‹¨ ë‚«ì§€ë§Œ ì—¬ì „íˆ ì´ˆë‚œê°í•œ í…ŒìŠ¤íŠ¸ë‹¤.  

```java
public class UserDaoTest {

    public static void main(String[] args) throws SQLException {

        UserDao userDao = new DaoFactory().userDao();

        User user = new User("hyewoncc4", "ìµœí˜œì›", "password");
        userDao.add(user);

        System.out.println("ë“±ë¡ ì„±ê³µ");

        User foundUser = userDao.get(user.getId());
        System.out.println(foundUser.getName());
        System.out.println(foundUser.getPassword());
        System.out.println(foundUser.getId() + " ì¡°íšŒ ì„±ê³µ");
    }
}
```  

<br>

1. ìˆ˜ë™ìœ¼ë¡œ ê²°ê³¼ë¥¼ í™•ì¸í•´ì•¼ í•œë‹¤  
ì´ ì½”ë“œëŠ” ìë™í™”ê°€ ëœ ë˜ì—ˆë‹¤. 
ì½˜ì†” ì°½ì— ì°íŒ `getName(), getPassword()`ê°€ ì •ë§ ì €ì¥ ëœ ê°’ê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ëŠ” ê²°êµ­ ì‚¬ëŒì´ ë³´ê³  íŒë‹¨í•´ì•¼ í•œë‹¤.  

2. ì‹¤í–‰ ì‘ì—…ì´ ë²ˆê±°ë¡­ë‹¤  
í˜„ì¬ëŠ” í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ê°€ í•˜ë‚˜ë¿ì´ì§€ë§Œ, ì´ëŸ° ì‹ìœ¼ë¡œ ë‚´ë¶€ì— `main()`ì„ í†µí•´ í…ŒìŠ¤íŠ¸í•˜ëŠ” í´ë˜ìŠ¤ê°€ ëŠ˜ì–´ë‚œë‹¤ë©´ ì¼ì¼íˆ ì‹¤í–‰í•˜ëŠ” ê²ƒë„ ë³´í†µ ì¼ì´ ì•„ë‹ˆê²Œ ë  ê²ƒì´ë‹¤.  

ì²«ë²ˆì§¸ ë¬¸ì œëŠ” ì½”ë“œë¥¼ ê°œì„ í•´ í•´ê²°í•  ìˆ˜ ìˆë‹¤.  

```java
public static void main(String[] args) throws SQLException {
    
    UserDao userDao = new DaoFactory().userDao();

    userDao.add(user);
    User user = new User("hyewoncc4", "ìµœí˜œì›", "password");    
    User foundUser = userDao.get(user.getId());
    
    if (!user.getName().equals(foundUser.getName())) {
        System.out.println("í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ : name");  
    }
    else if (!user.getPassword().equals(foundUser.getPassword())) {
        System.out.println("í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ : password");  
    } else {
        System.out.println("ì¡°íšŒ í…ŒìŠ¤íŠ¸ ì„±ê³µ");
    }
}
```

ì´ì œ ì½˜ì†”ì°½ì—ì„œ ê°’ì„ í™•ì¸í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. 
í•˜ì§€ë§Œ ì—¬ì „íˆ ë¬¸ì œê°€ ë‚¨ì•„ìˆë‹¤.  

<br>

### Junit ì ìš©í•˜ê¸°  

ì´ í…ŒìŠ¤íŠ¸ë¥¼ `Junit` í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•´ ë°”ê¿”ë³´ì. 
ì±…ì—ì„œëŠ” `Junit4`ë¥¼ ì‚¬ìš©í•˜ê³  ìˆì§€ë§Œ, `Junit5`ë¡œ ì˜ˆì œë¥¼ ë”°ë¼í–ˆë‹¤.  

```
testImplementation("org.junit.jupiter:junit-jupiter-api")
```

1ì¥ì˜ `xml`ë¶€ë¶„ì€ ì½”ë“œë¡œ ë”°ë¼í•˜ì§€ ì•Šì•˜ê³ , `@Configuration`ì„ í†µí•´ ë¹ˆì„ ìƒì„±í•´ì„œ ì±…ê³¼ ë‹¤ë¥¸ ë¶€ë¶„ì´ ìˆë‹¤.  

```java
class UserDaoTest {

    @DisplayName("ì‚¬ìš©ì ì¶”ê°€ ë° ì¡°íšŒ")
    @Test
    void addAndGet() throws SQLException {
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(DaoFactory.class);
        UserDao userDao = applicationContext.getBean("userDao", UserDao.class);

        User user = new User("yellow-cat", "ë…¸ë€ ê³ ì–‘ì´", "password");
        userDao.add(user);

        User foundUser = userDao.get(user.getId());
        assertEquals(user.getName(), foundUser.getName());
        assertEquals(user.getPassword(), foundUser.getPassword());
    }
}
```  

í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ë©´ **í•œë²ˆë§Œ** ì •ìƒì ìœ¼ë¡œ ëŒì•„ê°„ë‹¤. 
ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ìœ ë‹ˆí¬ ê°’ ì¤‘ë³µìœ¼ë¡œ `insert`ì— ì‹¤íŒ¨í•˜ê¸° ë•Œë¬¸ì´ë‹¤.  

![ìµœì´ˆ í…ŒìŠ¤íŠ¸ ì„±ê³µ](test_success.png)  
![ì¤‘ë³µ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨](test_fail.png)  

í…ŒìŠ¤íŠ¸ë¥¼ ì„±ê³µì‹œí‚¤ë ¤ë©´ DBì˜ ë°ì´í„°ë¥¼ ë¹„ì›Œì¤˜ì•¼ í•œë‹¤. 
ì´ë¥¼ `UserDao`ì— `deleteAll(), getCount()` ë©”ì„œë“œë¥¼ ë§Œë“¦ìœ¼ë¡œì¨ ë³´ì¶©í–ˆë‹¤. 
ê·¸ë¦¬ê³  ì±… ì˜ˆì œì˜ í…ŒìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ì´ ë§ì§€ ì•Šì•„, ê²°êµ­ ìŠ¤í”„ë§ ë¶€íŠ¸ ìŠ¤íƒ€í„° í…ŒìŠ¤íŠ¸ë¡œ ì˜ì¡´ì„±ì„ ë³€ê²½í•˜ê³  í‰ì†Œ ìŠ¤íƒ€ì¼ëŒ€ë¡œ ì‘ì„±í–ˆë‹¤... 

```
testImplementation("org.springframework.boot:spring-boot-starter-test")
```

```java
class UserDaoTest {

    @DisplayName("ì‚¬ìš©ì ì¶”ê°€ ë° ì¡°íšŒ")
    @Test
    void addAndGet() throws SQLException {
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(DaoFactory.class);
        UserDao userDao = applicationContext.getBean("userDao", UserDao.class);

        userDao.deleteAll();
        assertThat(userDao.getCount()).isEqualTo(0);

        User user = new User("yellow-cat", "ë…¸ë€ ê³ ì–‘ì´", "password");
        userDao.add(user);
        assertThat(userDao.getCount()).isEqualTo(1);

        User foundUser = userDao.get(user.getId());
        assertThat(foundUser.getName()).isEqualTo(user.getName());
        assertThat(foundUser.getPassword()).isEqualTo(user.getPassword());
    }
}
```

ì±…ì—ëŠ” `User`ë¥¼ ë‘ ë²ˆ ì¶”ê°€í•˜ê³  `getCount()`ì˜ ê°’ ì¦ê°€ë¥¼ í™•ì¸í•˜ê³ , ë‘ `User`ì˜ ê°’ì„ ê°ê° ìƒì„¸ ê²€ì¦í•˜ëŠ” ì½”ë“œê°€ ì¶”ê°€ë˜ì–´ ìˆë‹¤.   

<br>

### TDDë¡œ ê°œë°œí•˜ëŠ” ì˜ˆì™¸ì²˜ë¦¬  

ì˜ˆì™¸ì²˜ë¦¬ë¥¼ `TDD`ë¡œ ì†Œê°œí•œ ë¶€ë¶„ì´ ì¸ìƒê¹Šì—ˆë‹¤. 
í˜„ì¬ ì½”ë“œì—ì„œ `userDao.get(ì¡´ì¬í•˜ì§€ ì•ŠëŠ” id)`ë¥¼ í•˜ë©´ `EmptyResultDataAccessException`ì„ ë°œìƒì‹œí‚¤ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ê³  í•˜ì. 
ê·¸ëŸ¼ ì •ìƒì ìœ¼ë¡œ ë™ì‘ë˜ì–´ì•¼ í•  í…ŒìŠ¤íŠ¸ë¥¼ ë¨¼ì € ì‘ì„±í•œë‹¤.  

```java
@DisplayName("ì¡´ì¬í•˜ì§€ ì•ŠëŠ” id ì¡°íšŒ ì‹œ ì˜ˆì™¸")
@Test
void get_idDoesNotExists_throwException() throws SQLException {
    ApplicationContext applicationContext = new AnnotationConfigApplicationContext(DaoFactory.class);
    UserDao userDao = applicationContext.getBean("userDao", UserDao.class);

    userDao.deleteAll();

    assertThatThrownBy(() -> userDao.get("unknown_id"))
        .isInstanceOf(EmptyResultDataAccessException.class);
}
```

ì´ í…ŒìŠ¤íŠ¸ëŠ” ë‹¤ë¥¸ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ì„œ ì‹¤íŒ¨í•œë‹¤.  

```
java.lang.AssertionError: 
Expecting:
  <java.sql.SQLException: Illegal operation on empty result set.>
to be an instance of:
  <org.springframework.dao.EmptyResultDataAccessException>
but was:
  <"java.sql.SQLException: Illegal operation on empty result set.
```

ì´ì œ **í…ŒìŠ¤íŠ¸ë¥¼ í†µê³¼ì‹œí‚¬ ì½”ë“œ**ë¥¼ ê°œë°œí•˜ë©´ ëœë‹¤. 
`id`ë¡œ `User`ë¥¼ ì¡°íšŒí–ˆì„ ë•Œ ê²°ê³¼ê°€ ì—†ë‹¤ë©´ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ì.  

```java
public User get(final String id) throws SQLException {
    Connection connection = dataSource.getConnection();

    PreparedStatement statement = connection.prepareStatement(
        "select id, name, password from users where id = ?"
    );
    statement.setString(1, id);

    ResultSet resultSet = statement.executeQuery();
    User user = null;

    if (resultSet.next()) {
        user = new User();
        user.setId(resultSet.getString("id"));
        user.setName(resultSet.getString("name"));
        user.setPassword(resultSet.getString("password"));
    }

        resultSet.close();
        statement.close();
        connection.close();

    if (user == null) {
        throw new EmptyResultDataAccessException(1);
    }

    return user;
}
```

í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.  

<br>

### @Beforeê³¼ Junit ìƒëª…ì£¼ê¸°  

í˜„ì¬ í…ŒìŠ¤íŠ¸ëŠ” `userDao` ë¹ˆì„ ì»¨í…Œì´ë„ˆì—ì„œ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì´ ì¤‘ë³µë˜ì–´ìˆë‹¤. 
ì´ ì¤‘ë³µì„ Junitì˜ `@Before, @BeforeEach`ë¥¼ ì´ìš©í•´ ì œê±°í•  ìˆ˜ ìˆë‹¤.  

```java
class UserDaoTest {

    private UserDao userDao;

    @BeforeEach
    void setUp() {
        ApplicationContext applicationContext = new AnnotationConfigApplicationContext(DaoFactory.class);
        userDao = applicationContext.getBean("userDao", UserDao.class);
    }
    
    @Test
    void addAndGet() {...}

    @Test
    void get_idDoesNotExists_throwException() {...}
}
```

ì›ë˜ `@Before`ë„ ì‚¬ìš©í•´ë³´ë ¤ê³  í–ˆëŠ”ë°, `setUp()`ì´ í˜¸ì¶œë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. 
`Junit4`ì—ì„œëŠ” ëª¨ë‘ `public`ì´ì–´ì•¼ í–ˆë˜ ê²ƒ ê°™ì•„ì„œ í´ë˜ìŠ¤ì™€ ë©”ì„œë“œ ì ‘ê·¼ì œì–´ìë¥¼ ë°”ê¾¸ê¸° ë“±ë“± ì‹œë„í•´ë³´ì•˜ëŠ”ë° ì˜ ì•ˆëë‹¤... 
ì–´ì¨Œë“  `addAndGet(), get_idDoesNotExists_throwException()`ì´ ê°ê° ì‹¤í–‰ë  ë•Œ ìƒˆë¡œìš´ `UserDaoTest` ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒê¸°ê³  `setUp()`ì´ í˜¸ì¶œëœë‹¤. 
ì´ëŠ” í…ŒìŠ¤íŠ¸ ê°„ ê²©ë¦¬ë¥¼ ìœ„í•œ `Junit` ê¸°ë³¸ ìŠ¤í™ì´ë‹¤. 
ë§Œì•½ í…ŒìŠ¤íŠ¸ê°€ í•˜ë‚˜ì˜ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì´ë¤„ì ¸ì•¼ í•œë‹¤ë©´ ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ ìƒëª…ì£¼ê¸°ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.  

```java
@TestInstance(Lifecycle.PER_CLASS)
class UserDaoTest {
    ...
```

ì±…ì—ì„œëŠ” ìƒì„±ë˜ëŠ” `User` í”½ìŠ¤ì³ë„ `setUp()`ì„ í†µí•´ ì„¤ì •í•˜ê²Œ ë°”ê¿”ë‘ì—ˆëŠ”ë°... ê¹ƒí—™ì— ì˜¬ë¦¬ì§„ ì•Šì•˜ë‹¤. 
ë§ì€ ê²½ìš°ì— í”½ìŠ¤ì³ì™€ ì´ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì½”ë“œëŠ” ê±°ë¦¬ê°€ ê°€ê¹Œìš´ ê²Œ ì¢‹ë‹¤ëŠ” ìƒê° ë•Œë¬¸ì´ë‹¤. 
ì•„ë§ˆ `@Before`ë¡œ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•˜ëŠ” ë°©ì‹ì„ ë³´ì—¬ì£¼ë ¤ê³  ì—¬ê¸°ì—ë„ ì ìš©í•˜ì‹  ê²ƒ ê°™ë‹¤.  

<br>

### í…ŒìŠ¤íŠ¸ ê°„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ê³µìœ   

ì†”ì§íˆ ì´ ë¶€ë¶„ì€ ê´œíˆ ìµìˆ™í•œ ëŒ€ë¡œ í•˜ê² ë‹¤ê³  í•˜ë‹¤ê°€... ì±…ì˜ ì„¤ëª…ì„ ì˜ ì´í•´í•˜ì§€ ëª»í–ˆë‹¤. 
`@RunWith(SpringJunit4ClassRunner.class)`ì™€ `@SpringBootTest`ê°€ ë¹„ìŠ·í•œ ì—­í• ì„ í•´ì£¼ëŠ” ê²ƒ ê°™ë‹¤ëŠ” ê²ƒë§Œ ì¶”ë¡ í–ˆë‹¤.  

```java
// ê·¸ë¦¬ê³  ì´ì¯¤ì—ì„œ DaoFactory ë¼ëŠ” ì´ë¦„ì´ ëª¹ì‹œ ì˜ëª»ë˜ì—ˆë‹¤ëŠ”ê²Œ ë³´ì—¬ì„œ AppConfigë¡œ ë°”ê¿¨ë‹¤  
@SpringBootTest
@ContextConfiguration(classes = DaoFactory.class)
class UserDaoTest {
    
    @Autowired
    private ApplicationContext applicationContext;
    
    private UserDao userDao;
    
    @BeforeEach
    void setUp() {
        userDao = applicationContext.getBean("userDao", UserDao.class);
    }
    ...
```

ì½˜ì†”ë¡œ ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œì—ì„œ `this(UserDaoTestì˜ ì¸ìŠ¤í„´ìŠ¤)`ì™€ `applicationContext`ë¥¼ ì°ì–´ë³´ë©´, 
`UserDaoTest`ëŠ” ë§¤ë²ˆ ìƒˆ ì¸ìŠ¤í„´ìŠ¤ê°€ ë§Œë“¤ì–´ì§ì—ë„ ë¶ˆêµ¬í•˜ê³  `applicationContext`ì€ ê°™ì€ ì¸ìŠ¤í„´ìŠ¤ê°€ ì¬í™œìš©ë¨ì„ ë³¼ ìˆ˜ ìˆë‹¤. 
`ApplicationContext`ë„ ìŠ¤í”„ë§ ë¹ˆìœ¼ë¡œ ë“±ë¡ë˜ê¸° ë•Œë¬¸ì´ë‹¤. 
ë§Œì•½ ë™ì¼í•˜ê²Œ `@ContextConfiguration(classes = DaoFactory.class)`ë§Œ ì‚¬ìš©í•˜ëŠ” (ê·¸ëŸ¬ë‹ˆê¹Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ ì„¤ì •ì´ ê°™ì€) ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ê°€ ìˆë‹¤ë©´, 
ê·¸ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë“¤ê³¼ë„ ë™ì¼í•œ `applicationContext`ë¥¼ ê³µìœ í•œë‹¤. 
ì¸ìˆ˜í…ŒìŠ¤íŠ¸ë¥¼ ë°°ìš°ë©° ì•Œê²Œëœ `@DirtiesContext`ë¡œ ìƒˆë¡œìš´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ë„ë¡ ê°•ì œí•  ìˆ˜ ìˆë‹¤.  

ì•„ì˜ˆ `UserDao`ë¥¼ ì£¼ì…ë°›ë„ë¡ ë³€ê²½í•  ìˆ˜ë„ ìˆë‹¤.  

```java
@SpringBootTest
@ContextConfiguration(classes = AppConfig.class)
class UserDaoTest {

    @Autowired
    private UserDao userDao;
    ...
```

`DataSource`ë¥¼ ì£¼ì…ë°›ì•„ í…ŒìŠ¤íŠ¸ì—ì„œ ë‹¤ë¥¸ DBë¥¼ ì‚¬ìš©í•˜ë„ë¡ í•  ìˆ˜ë„ ìˆë‹¤.  

```java
@SpringBootTest
@ContextConfiguration(classes = TestAppConfig.class)
class UserDaoTest {

    @Autowired
    private DataSource dataSource;
    ...

@Configuration
public class TestAppConfig {

    @Bean
    public DataSource dataSource() {
        SimpleDriverDataSource dataSource = new SimpleDriverDataSource();

        dataSource.set...;

        return dataSource;
    }
}
```

ì±…ê³¼ ê°™ì€ ë°©ì‹ì€ ì•„ë‹ˆì§€ë§Œ ì˜ˆì „ì— [í…ŒìŠ¤íŠ¸ì—ì„œë§Œ ë¹ˆ ê°ˆì•„ ë¼ìš°ê¸°](https://hyewoncc.github.io/spring-study-1/)ë¥¼ ê³ ë¯¼í•œ ì  ìˆì–´ì„œ ë°˜ê°€ì› ë‹¤.  

<br>

### ì•„ë‹ˆë©´, ì»¨í…Œì´ë„ˆë¥¼ ì—†ì• ë²„ë¦¬ê¸°  

ìˆœìˆ˜í•˜ê²Œ `UserDao`ë§Œ í…ŒìŠ¤íŠ¸ í•  ê²ƒì´ë¼ë©´ ì´ëŸ° ì‹ìœ¼ë¡œ `DI`ë¥¼ í•  ìˆ˜ ìˆë‹¤.  

```java
class UserDaoTest {

    private UserDao userDao;

    @BeforeEach
    void setUp() {
        userDao = new UserDao();
        userDao.setDataSource(dataSource());
    }
    
    private DataSource dataSource() {
        SimpleDriverDataSource dataSource = new SimpleDriverDataSource();

        dataSource.setDriverClass(com.mysql.cj.jdbc.Driver.class);
        dataSource.setUrl("jdbc:mysql://localhost:3306/springbook?serverTimezone=Asia/Seoul");
        dataSource.setUsername("spring");
        dataSource.setPassword("book");

        return dataSource;
    }
    ...
```

ìš°í…Œì½” ë ˆë²¨1ì—ì„œ [ì½˜ì†” ì²´ìŠ¤ ê²Œì„ ë§Œë“¤ê¸° ë¯¸ì…˜](https://github.com/woowacourse/java-chess)ì„ í•  ë•Œ, 
ì²´ìŠ¤íŒì„ ëœ»í•˜ëŠ” `Board` ê°ì²´ë¥¼ í…ŒìŠ¤íŠ¸ì—ì„œ `DI`ë¥¼ ì´ìš©í•´ ì´ˆê¸°í™”í•´ì¤¬ë‹¤.  

```java
public Board(final PiecesSetup piecesSetup) {
    pieces = new Pieces(piecesSetup);
}

public interface PiecesSetup {
    Map<Position, Piece> initialize();
}

@Test
@DisplayName("í°ì€ ìƒëŒ€ê¸°ë¬¼ì´ ëª©ì ì§€ì— ì¡´ì¬í•˜ë©´ ëŒ€ê°ì„ ìœ¼ë¡œ ì›€ì§ì¼ ìˆ˜ ìˆë‹¤")
void pawnCanMoveDiagonal_targetExist() {
    Piece whitePawn = new Piece(Color.WHITE, new Pawn());
    Board board = new Board(() -> {
        Map<Position, Piece> pieces = new HashMap<>();
        pieces.put(Position.of("a2"), whitePawn);
        pieces.put(Position.of("b3"), new Piece(Color.BLACK, new Pawn()));
        return pieces;
    });

    board.move("a2", "b3");
    assertThat(board.findPiece(Position.of("b3")).get()).isEqualTo(whitePawn);
}
```

ì´ë ‡ê²Œ í…ŒìŠ¤íŠ¸ ìƒí™©ì— ë§ëŠ” ë°ì´í„°ë¥¼ ì£¼ì…í•´ ìƒì„±í•  ìˆ˜ ìˆì—ˆë‹¤. 
`DI`ê°€ ìŠ¤í”„ë§ì— ì¢…ì†ì ì¸ ê¸°ìˆ ì´ ì•„ë‹ˆë¼ëŠ” ê±¸, ìˆœìˆ˜(?) ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ì²´ë“í•  ìˆ˜ ìˆì—ˆë‹¤.  

ì „ì²´ ì‹¤ìŠµ ì½”ë“œëŠ” [ê¹ƒí—™ topring ë ˆí¬](https://github.com/hyewoncc/topring/tree/chapter2)ì—ì„œ ë³¼ ìˆ˜ ìˆë‹¤.

<br>

## í•™ìŠµí…ŒìŠ¤íŠ¸ë¥¼ ë§Œë“¤ì!  

í† í”„ë§ ë‚´ìš© ìš”ì•½ì€ ìœ„ì—ì„œ ê±°ì˜ ëë‚¬ê³ , ì—¬ê¸°ëŠ” ë²ˆì™¸ ëŠë‚Œì´ë‹¤. 
í•™ìŠµí…ŒìŠ¤íŠ¸ë¡œ í•™ìŠµì„ í•œë²ˆì´ë¼ë„ í•´ ë³¸ ì‚¬ëŒë“¤ì€ í•™ìŠµí…ŒìŠ¤íŠ¸ì˜ âœ¨ë©‹ì§âœ¨ì„ ì•Œ ê²ƒì´ë‹¤. 
ë‚˜ëŠ” í‰ì†Œì— `XXX-sandbox`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ì–´ ê³µë¶€í•œ ì½”ë“œë¥¼ ì •ë¦¬í•˜ê³ , ë¸”ë¡œê·¸ì— ì˜¬ë¦´ ì˜ˆì œ ì½”ë“œë¥¼ ê¹ƒí—™ì— ì˜¬ë¦°ë‹¤. 
ì†”ì§íˆ ê³µë¶€ê°€ ì˜ë˜ëŠ” ê±´ ë‘˜ì§¸ì¹˜ê³ ... ì •ë§ í›Œë¥­í•œ ì»¤ë‹í˜ì´í¼ê°€ ë˜ì–´ì¤€ë‹¤. 
ì½”í‹€ë¦°ìœ¼ë¡œ given/when/then í…ŒìŠ¤íŠ¸ ì–´ë–»ê²Œ ì‘ì„±í–ˆë”ë¼? í•˜ë©´ êµ¬ê¸€ì—ì„œ ê²€ìƒ‰í•˜ê³  ë¸”ë¡œê·¸ì˜ ì½”ë“œë¸”ëŸ­ ê¸ì–´ì˜¤ê³  í•  í•„ìš” ì—†ì´ ê·¸ëƒ¥ í”„ë¡œì íŠ¸ ì¼œì„œ ë³´ë©´ ëœë‹¤.  

```kotlin
internal class BehaviorTest: BehaviorSpec({

    given("whenìœ¼ë¡œ ë™ë¬¼ ì†Œë¦¬ë£° ì°¾ìœ¼ë©´") {
        val grammar = Grammar()

        `when`("ê³ ì–‘ì´ëŠ”") {
            val name = "cat"
            val sound = grammar.whenAnimalSound(name)
            then("ì•¼ì˜¹ì´ ë‚˜ì˜¨ë‹¤") {
                sound shouldBe "meow"
            }
        }

        `when`("ê°œëŠ”") {
            val name = "dog"
            val sound = grammar.whenAnimalSound(name)
            then("ë©ë©ì´ ë‚˜ì˜¨ë‹¤") {
                sound shouldBe "woff"
            }
        }

        `when`("ì´ë¦„ ëª¨ë¥¼ ë™ë¬¼ì€") {
            val name = "x"
            val sound = grammar.whenAnimalSound(name)
            then("unknownì´ ë‚˜ì˜¨ë‹¤") {
                sound shouldBe "unknown"
            }
        }
    }
})
```

ë§‰ìƒ ì˜¬ë¦¬ë ¤ë‹ˆ ë¶€ë„ëŸ½ê¸´í•œë° ì–´ì¨Œë“  ì´ëŸ°ì‹ìœ¼ë¡œ ì •ë¦¬í•´ë‘ê³  ìœ ìš©í•˜ê²Œ ë² ë¼ê³  ìˆë‹¤.  

<br>

ì´ë²ˆ ì¥ì€ ì§€ë‚œë²ˆ ë³´ë‹¤ ê°€ë³ê²Œ ì½ì—ˆë‹¤. 
í…ŒìŠ¤íŠ¸ë¥¼ ëª¨ë¥´ë˜ ë•Œ ì½ì—ˆë‹¤ë©´ ì–´ë• ì„ê¹Œ? 
ê°ë™ë°›ì•„ì„œ í…ŒìŠ¤íŠ¸ ì‹ ë´‰ìê°€ ë˜ì—ˆì„ê¹Œ, ì•„ë‹ˆë©´ ì´ëŸ°ê²Œ ìˆêµ¬ë‚˜ í•˜ê³  ë„˜ì–´ê°”ì„ê¹Œ. 
ì–´ì¨Œë“  ì§€ê¸ˆì€ í…ŒìŠ¤íŠ¸ì—†ëŠ” ê°œë°œì´ ë¶€ì‹¤ê³µì‚¬ë¡œ ë³´ì¸ë‹¤. 
ê·¸ëŸ° ì½”ë“œëŠ” ë¹¨ë¦¬ ì§„í–‰ë˜ëŠ” ê²ƒ ê°™ì•„ë„ í•œë²ˆ ë¬´ë„ˆì§€ë©´ ê²‰ì¡ì„ ìˆ˜ ì—†ê²Œ ëœë‹¤. 
í…ŒìŠ¤íŠ¸ì˜ ë©‹ì§ì„ ì•Œê²Œ ë˜ê³  ë‚˜ì„œëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê±°ë‚˜ ë¦¬íŒ©í„°ë§ í•œ ë’¤ì— ì „ì²´ í…ŒìŠ¤íŠ¸ë¥¼ ëŒë¦¬ê³  ì´ˆë¡ë¶ˆì´ ì¼ì‚¬ë¶„ë€í•˜ê²Œ ì¼œì§€ëŠ” ê±¸ ë³´ëŠ” ì¬ë¯¸ë¡œ ì½”ë“œë¥¼ ì§ ë‹¤. 
ë‹¤ìŒì¥ì€ í›‘ì–´ë³´ë‹ˆ ë§Œë§Œì¹˜ ì•Šì€ ê²ƒ ê°™ì€ë° ë‹¤ìŒì£¼ê°€ ê¸°ëŒ€ëœë‹¤. 

ê·¸ë¦¬ê³  í¬ìŠ¤íŒ… ì œëª©ì„ ìœ„íŠ¸ìˆê²Œ ì§“ê³  ì‹¶ì—ˆëŠ”ë° ì•„ë¬´ ìƒê°ë„ ë‚˜ì§€ ì•Šì•„ì„œ ì´ëª¨ì§€ë‚˜ ë¶™ì˜€ë‹¤. 
í…ŒìŠ¤íŠ¸ì˜ ë©‹ì§ì´ ì „í•´ì§€ë©´ ì¢‹ê² ë‹¤...

<br>

```toc
```
