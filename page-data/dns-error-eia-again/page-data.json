{"componentChunkName":"component---src-templates-blog-template-js","path":"/dns-error-eia-again/","result":{"data":{"cur":{"id":"bf219710-390f-5cde-918c-40c4ce3086ca","html":"<h2 id=\"️-문제-상황\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9\" aria-label=\"️ 문제 상황 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⚡️ 문제 상황</h2>\n<p>언젠가부터 백엔드 서버 배포 직후에 아주 짧은 서비스 순단이 일어났다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 10.555555555555557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZ0lEQVR42m2MSwqAIBRF2/92oq3UIIg+A7Wflk/7WN5IokkduHAGhxvxQUHbBTfe+7CbiQy0scE7qVALCSEyNEUC0u3Tn2+/7Q6TXRGxXkKb/8OZTHDej6jYCMFTlHkMovbTb+4Ihxf2oJqshiIhMAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"데이터독 로그\"\n        title=\"\"\n        src=\"/static/8aef0bdae49e0e866850d2f48ebcb9b4/37523/datadog_log.png\"\n        srcset=\"/static/8aef0bdae49e0e866850d2f48ebcb9b4/e9ff0/datadog_log.png 180w,\n/static/8aef0bdae49e0e866850d2f48ebcb9b4/f21e7/datadog_log.png 360w,\n/static/8aef0bdae49e0e866850d2f48ebcb9b4/37523/datadog_log.png 720w,\n/static/8aef0bdae49e0e866850d2f48ebcb9b4/302a4/datadog_log.png 1080w,\n/static/8aef0bdae49e0e866850d2f48ebcb9b4/07a9c/datadog_log.png 1440w,\n/static/8aef0bdae49e0e866850d2f48ebcb9b4/d3d45/datadog_log.png 1614w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>배포 직후 외부 API를 호출 할 때 DNS 조회에 실패하는 걸로 추정되었다.\n여러번 발생하는 에러가 아니기에 다른 팀원이 애플리케이션 실행 후 트래픽 허용 전, <code class=\"language-text\">nslookup</code>으로 호출하는 모든 도메인을 한 번씩 조회하도록 배포 스크립트를 수정했다.\nDNS 조회 결과를 캐싱할 것으로 기대했기 때문이다.</p>\n<p>하지만 조치 후에도 여전히 <code class=\"language-text\">EAI_AGAIN</code>이라는 동일한 에러 메시지와 함께 순단이 발생했다.\n순단으로 인해 틀어진 여러 정합을 수동으로 맞춰야 하는 상황을 없애기 위해 이번 스프린트에 해결을 목표했다.</p>\n<br>\n<h2 id=\"-eai_again은-어디에서-오는가\" style=\"position:relative;\"><a href=\"#-eai_again%EC%9D%80-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%98%A4%EB%8A%94%EA%B0%80\" aria-label=\" eai_again은 어디에서 오는가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧶 EAI_AGAIN은 어디에서 오는가</h2>\n<p>이 코드를 누가 언제 왜 던지는가 부터 알기 위해 라이브러리를 포함해 코드를 검색했는데 나오지 않았다.\n그래서 함수 이름으로 추정되는 <code class=\"language-text\">getaddrinfo</code>를 검색해보고, 에러 콜스택도 읽어봤다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAZklEQVR42i2MgQqAIAxE+/+/LA1EnVMrxQwuthqMd/cGW67xYM6J4zwRIsHHiECkWdbuO6y1ynXdsBmj/eN3897DOQdmxoJ/xhigxOBclPKs1AORkrrEGblUpXhx0iW31tF6x31PvLn4l5LSsxdjAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"에러 콜스택\"\n        title=\"\"\n        src=\"/static/3d841a7863112fee934981180cac0112/37523/error_call_stack.png\"\n        srcset=\"/static/3d841a7863112fee934981180cac0112/e9ff0/error_call_stack.png 180w,\n/static/3d841a7863112fee934981180cac0112/f21e7/error_call_stack.png 360w,\n/static/3d841a7863112fee934981180cac0112/37523/error_call_stack.png 720w,\n/static/3d841a7863112fee934981180cac0112/302a4/error_call_stack.png 1080w,\n/static/3d841a7863112fee934981180cac0112/07a9c/error_call_stack.png 1440w,\n/static/3d841a7863112fee934981180cac0112/7db30/error_call_stack.png 1494w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>프로젝트 및 노드 모듈 코드 내에 <code class=\"language-text\">getaddrinfo</code>라는 함수는 없었고, 대신 노드 모듈 내의 <code class=\"language-text\">dns.d.ts</code> 파일의 주석에 언급이 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"> <span class=\"token operator\">*</span> See the <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Implementation considerations section</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token keyword\">for</span> more information<span class=\"token punctuation\">.</span>\n <span class=\"token operator\">*</span> <span class=\"token decorator\"><span class=\"token at operator\">@</span><span class=\"token function\">see</span></span> <span class=\"token punctuation\">[</span>source<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>https<span class=\"token operator\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span>github<span class=\"token punctuation\">.</span>com<span class=\"token operator\">/</span>nodejs<span class=\"token operator\">/</span>node<span class=\"token operator\">/</span>blob<span class=\"token operator\">/</span>v16<span class=\"token punctuation\">.</span><span class=\"token number\">9.0</span><span class=\"token operator\">/</span>lib<span class=\"token operator\">/</span>dns<span class=\"token punctuation\">.</span>js<span class=\"token punctuation\">)</span>\n <span class=\"token operator\">*</span><span class=\"token operator\">/</span>\n<span class=\"token keyword\">declare</span> <span class=\"token keyword\">module</span> <span class=\"token string\">'dns'</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span> <span class=\"token keyword\">as</span> dnsPromises <span class=\"token keyword\">from</span> <span class=\"token string\">'node:dns/promises'</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// Supported getaddrinfo flags.</span>\n    <span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token constant\">ADDRCONFIG</span><span class=\"token operator\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">...</span></code></pre></div>\n<br>\n<p>그리고 해당 파일의 제일 상단 주석에서 node DNS 모듈 내 <code class=\"language-text\">lockup()</code>과 다른 메서드들의 역할을 알 수 있었다.</p>\n<blockquote>\n<p>The <code class=\"language-text\">dns</code> module enables name resolution. For example, use it to look up IP addresses of host names. Although named for the <a href=\"https://en.wikipedia.org/wiki/Domain_Name_System\">Domain Name System (DNS)</a>, it does not always use the DNS protocol for lookups… (생략)</p>\n</blockquote>\n<p>설명은 대략 이런 내용이었다.</p>\n<p><code class=\"language-text\">dns.lookup()</code>은 DNS 조회를 운영체제 기능을 통해 수행한다. 네트워크 통신이 일어나지 않을 수도 있다.\n시스템의 다른 애플리케이션들과 동일한 방식으로 동작하는 DNS 조회를 할 수 있다.</p>\n<p>반면 다른 메서드들은 실제 DNS 서버에 연결해 항상 네트워크를 통해 조회한다. <code class=\"language-text\">lookup()</code>과 사용하는 설정값이 다르다.\n다른 DNS 조회 기능을 사용하지 않고 언제나 네트워크를 통해 수행하고 싶다면 <code class=\"language-text\">resolve()</code>와 같은 다른 메서드를 사용하면 된다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB20lEQVR42n3PTWiSARzH8R061cE5bDmfpsu09QQqDV0WMnKtZ9q0lpYWsaHEGFnCoKIGCyrKw3aIXk6xWxRF1KW9pfXQXizKgl7oYDRih7EOvtZV/cbsUtR2+vE7/D/8/jUAlUplOSgWcgQCHqQDLiSvxKmgHc/+Dvw9fjwBD26/i7Y9rbS7d2HebqBerWBiaqJ6WyqVqlnzJ1go5OkLdRMJd3E9YiF+vpETPe30RvsJhgIEQ0FcB/fS6ZNosYmIFh0JOf4vWC6Xq2UpU+DsMSvyORVzQypmhlTcjRpwdzqwOXZgbTXTYjdhtVtwudqwOcwk5Kf/W/gbzObzHO6WeHKmAXlQ4EFEz2h4M8PhrezzSex02hi5ESOd/sTX+TTuQ26mnk2uvDCXyyLoDBx3buB1rIEXl+q5E9Xw+LSRI0Ev3qMBPnz+SPFnjkf3byNs28jcm+TKYDaTQWjSolHU8dCjYaZPYCzUxNhuPbdszYwOiLwbv8ni4gLXBjrQmfQkU69WAbMZjGIzW9QC4+tqSa1VMKmtI+FUMXtSyezlRt7K98j9KBK7MojWtGl1cPll0WTBIqiZrlXyfo2CeNd6pkcEnvcqGe73Mf99iW8LX7h49QJGq0gy9fIv8Bcj4MGUs39DGwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"푸 노안 짤\"\n        title=\"\"\n        src=\"/static/c9327bf6aee2bb3e651f1e359117c6df/37523/pooh.png\"\n        srcset=\"/static/c9327bf6aee2bb3e651f1e359117c6df/e9ff0/pooh.png 180w,\n/static/c9327bf6aee2bb3e651f1e359117c6df/f21e7/pooh.png 360w,\n/static/c9327bf6aee2bb3e651f1e359117c6df/37523/pooh.png 720w,\n/static/c9327bf6aee2bb3e651f1e359117c6df/302a4/pooh.png 1080w,\n/static/c9327bf6aee2bb3e651f1e359117c6df/07a9c/pooh.png 1440w,\n/static/c9327bf6aee2bb3e651f1e359117c6df/c0566/pooh.png 1544w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<p>난 에러 코드의 뜻을 알고 싶었을 뿐인데 서먹한 개념들만 나온다…\n에러 콜스택에서 <code class=\"language-text\">onlookup()</code>이라는 비슷한 이름의 메서드를 봤으니 이 메서드를 찾아봤다.</p>\n<p>어쩐지 모듈 내 코드에는 없고, 주석에 링크가 있던 <code class=\"language-text\">dns.js</code> 파일에서 발견할 수 있었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">onlookup</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> addresses</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token function\">dnsException</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">,</span> <span class=\"token string\">'getaddrinfo'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>hostname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> addresses<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>family <span class=\"token operator\">||</span> <span class=\"token function\">isIP</span><span class=\"token punctuation\">(</span>addresses<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">lookup</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">hostname<span class=\"token punctuation\">,</span> options<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> hints <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> family <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> all <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> verbatim <span class=\"token operator\">=</span> <span class=\"token function\">getDefaultVerbatim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span>\n\n  <span class=\"token keyword\">const</span> req <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">GetAddrInfoReqWrap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 콜스택에서 본 친구다!  </span>\n  req<span class=\"token punctuation\">.</span>callback <span class=\"token operator\">=</span> callback<span class=\"token punctuation\">;</span>\n  req<span class=\"token punctuation\">.</span>family <span class=\"token operator\">=</span> family<span class=\"token punctuation\">;</span>\n  req<span class=\"token punctuation\">.</span>hostname <span class=\"token operator\">=</span> hostname<span class=\"token punctuation\">;</span>\n  req<span class=\"token punctuation\">.</span>oncomplete <span class=\"token operator\">=</span> all <span class=\"token operator\">?</span> onlookupall <span class=\"token operator\">:</span> onlookup<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 완료되면 onlookup을 호출하는구나 짐작된다  </span>\n  <span class=\"token operator\">...</span>\n\n  <span class=\"token keyword\">return</span> req<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>콜스택에서 봤던 <code class=\"language-text\">GetAddrInfoReqWrap.onlookup()</code>가 있었고, 해당 모듈과 다른 모듈의 테스트 코드에서 에러 코드를 찾을 수 있었다.</p>\n<br>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> dnsPromises <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dns'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>promises<span class=\"token punctuation\">;</span>\n\ndnsPromises<span class=\"token punctuation\">.</span><span class=\"token function\">lookupService</span><span class=\"token punctuation\">(</span><span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>common<span class=\"token punctuation\">.</span><span class=\"token function\">mustCall</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ssh'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'22'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>service<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  assert<span class=\"token punctuation\">.</span><span class=\"token function\">strictEqual</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> result<span class=\"token punctuation\">.</span>hostname<span class=\"token punctuation\">,</span> <span class=\"token string\">'string'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  assert<span class=\"token punctuation\">.</span><span class=\"token function\">notStrictEqual</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>hostname<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// Use an IP from the RFC 5737 test range to cause an error.</span>\n<span class=\"token comment\">// Refs: https://tools.ietf.org/html/rfc5737</span>\nassert<span class=\"token punctuation\">.</span><span class=\"token function\">rejects</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> dnsPromises<span class=\"token punctuation\">.</span><span class=\"token function\">lookupService</span><span class=\"token punctuation\">(</span><span class=\"token string\">'192.0.2.1'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">code</span><span class=\"token operator\">:</span> <span class=\"token regex\"><span class=\"token regex-delimiter\">/</span><span class=\"token regex-source language-regex\">^(?:ENOTFOUND|EAI_AGAIN)$</span><span class=\"token regex-delimiter\">/</span></span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br>\n<p><code class=\"language-text\">dns.lookup()</code>이 OS 기능을 사용한다는 것과 에러 코드 정의가 없는 것을 봤을 때, <code class=\"language-text\">EAI_AGAIN</code>은 OS에서 반환하는 코드인 것 같았다.\n그렇다면 배포 스크립트의 <code class=\"language-text\">nslookup</code>이 성공하지 않았던 것일까?\n배포 로그를 봤을 때 그건 아니었다. 잘 조회되고 있었다.</p>\n<p>사실 이쯤 해서 시도할 해결책은 결정나 있었다.\n팀원이 언급한 적 있던 <a href=\"https://github.com/yahoo/dnscache\">dnscache</a>로 노드 애플리케이션에서 별도 캐싱을 적용하는 것이었다.\n서버 로그를 봤을 때, 배포 직후 첫 요청에 실패하는 것이 아니라 새로운 서버에 트래픽이 흐르고 1~2분 지났을 시점에 한두건의 요청이 실패한다는 특정한 패턴이 있었다.\n그래서 애플리케이션 단에서 캐싱을 적용하면 해결될 것으로 기대했다.</p>\n<p>어쨌든 에러 코드의 명확한 스펙을 알게된 건 아니라 더 찾아보았다.\n사실 여기서 시간을 엄청나게 소비했는데…\n검색해보면 정보가 잘 안나왔다.</p>\n<p>특히 노드 모듈 테스트 코드도 그랬고, 틀린 도메인이나 설정값으로 요청해서 해당 에러가 생기는 경우가 대부분이었다.\n우리처럼 정상적으로 동작하다가 에러가 발생하고, 다시 정상적으로 되는 경우는 없었다.\n공식 문서 찾기에 지쳤을 때 문득 생각나서 빙챗으로 검색을 했는데 <a href=\"https://man7.org/linux/man-pages/man3/getaddrinfo.3.html\">linux 문서</a>를 바로 알려주는 것이었다.</p>\n<br>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30.555555555555554%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA9klEQVR42mVQi2rDMBDr///fWsbiOo82Xhrn/bJ9TjTuIGNlB0LiMLJOlznPMagEze2KuTKYVo8QCEQBIQQQkfC2bcJ/4b2Hc040z3EcuLAIkaCTTxSpQmVKlKVBnudY11UwzzOapsGyLKJPTNOEvu9Fvxs6B2seeKYJHvoL09AjECHGKOCHjH3ff5n3nIz1acYjhocsD7SNxe36AX2/wxiDoiiglBLWWiPLMtGcfhxHdF0nqf8ZUvDoXgbfRYp1WUAxSncM7o57YvD5zLzjZOcbTvt28r5HxOBRvyqkWksKTlPXtXR0dmWtlWTDMAi3bSvgT07DH7c/zhlMRv64AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"리눅스 문서\"\n        title=\"\"\n        src=\"/static/357ffa25bfba15ab254061ef09a3ff60/37523/linux_docs.png\"\n        srcset=\"/static/357ffa25bfba15ab254061ef09a3ff60/e9ff0/linux_docs.png 180w,\n/static/357ffa25bfba15ab254061ef09a3ff60/f21e7/linux_docs.png 360w,\n/static/357ffa25bfba15ab254061ef09a3ff60/37523/linux_docs.png 720w,\n/static/357ffa25bfba15ab254061ef09a3ff60/302a4/linux_docs.png 1080w,\n/static/357ffa25bfba15ab254061ef09a3ff60/07a9c/linux_docs.png 1440w,\n/static/357ffa25bfba15ab254061ef09a3ff60/a8c87/linux_docs.png 1538w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<br>\n<p>그리고 이 함수에 대해 상세한 설명을 해주신 블로그 글 <a href=\"https://techlog.gurucat.net/293\">[네트워크/C] getaddrinfo 함수 - 제임스 딘딘</a>도 함께 알려주었다.\n문서에 따르면 일시적인 조회 실패로, 잠시 후 다시 시도하라는 뜻이었다.</p>\n<p>모든 외부 API 호출이 해당 사유로 실패 가능했기 때문에, 전역적인 재시도 처리를 하는 것도 방법이었다.\n그래도 캐싱으로 충분할 것 같아 <code class=\"language-text\">dnscache</code>를 적용했다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dnscache'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">enable</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>해당 모듈을 적용하면 전역적으로 모든 <code class=\"language-text\">dns</code> 메서드를 래핑해준다 한다.</p>\n<p>적용 후 테스트 환경에서 세차례 정도 배포해보았는데, 순단이 발생하지 않았다.\n그래서 프로덕션에도 적용해 배포해본 결과 일단은 무찌른 것 같다. 아마도…</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA2klEQVR42p1R22rDMAzN///dYPRhfSgrdKXFtSw7thI7ySly15ayDTILDgJfpHPpUkpwRLgYA2ZGCAF6tiwLtO59bXX62ZLD7nACOfe40EEt6Pq+R0wJQy6Y57mJ1QvDQQRMhKmUP5npojW4MfQevP/E1/EAYwystSCiB5xzUBW/Qf0OPtQeY0QpBZ2yYnbYnc44mgtEBNM0IZdSHyjWePcSSpIBhiOGccTyTb2lquQkcpNnLfI4VoY55/aUg+fqk/e+yntua0z5bfOOj+0W1hKYzshCP9L+z8ArzJgSh1U3+2EAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"슬랙\"\n        title=\"\"\n        src=\"/static/07140bbe82d85b9668a7168d790c09dd/37523/slack.png\"\n        srcset=\"/static/07140bbe82d85b9668a7168d790c09dd/e9ff0/slack.png 180w,\n/static/07140bbe82d85b9668a7168d790c09dd/f21e7/slack.png 360w,\n/static/07140bbe82d85b9668a7168d790c09dd/37523/slack.png 720w,\n/static/07140bbe82d85b9668a7168d790c09dd/302a4/slack.png 1080w,\n/static/07140bbe82d85b9668a7168d790c09dd/07a9c/slack.png 1440w,\n/static/07140bbe82d85b9668a7168d790c09dd/bfe41/slack.png 2082w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div style=\"text-align:center; font-style:italic; color:grey;\">\n  진짜로 순간 속았음  \n</div>  \n<br>  \n<h2 id=\"-잘-하는-개발자는-어떻게-될-수-있나요\" style=\"position:relative;\"><a href=\"#-%EC%9E%98-%ED%95%98%EB%8A%94-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%90%A0-%EC%88%98-%EC%9E%88%EB%82%98%EC%9A%94\" aria-label=\" 잘 하는 개발자는 어떻게 될 수 있나요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🛶 잘 하는 개발자는 어떻게 될 수 있나요</h2>\n<p>사실 글로만 보면 꽤 간단하게 해결한 것 같은데!!!\n여기에 페어로 이틀을 꼬박 소모했다.</p>\n<p>이유는 이 에러가 프로덕션 무중단 배포 시에만 발생했는데, 스테이지 환경은 동일한 배포 파이프라인이 구축되어 있지 않아서 재연이 어려웠기 때문이다.\n원인을 확실하게 알지 못하니 재연된 스테이지 환경에 적용 후 해결 되었는지 봐야 했는데…\n여러가지 다양한 이유로 재연 환경을 구축하기가 만만치 않았다.\n사실 나는 조수석에 앉아있었고 든든한 페어가 멋지게 뚝딱뚝딱 구축해줬지만…</p>\n<p>잘 하고 싶다는 고민이 많은 요즘이다.\n내가 생각하는 ‘잘 하는 개발자’는 언어나 분야에 제약받지 않는 사람이다.\n예를 들어, 정말 그림을 잘 그리는 사람은 동양화를 주로 그렸어도, 대리석 조각을 깎으라 시키면 잘 할 수 있다.\n동양화를 그리면서 체득한 양감이나 구도에 대한 이해와 손을 쓰는 능력은 조각에도 적용되기 때문이다.</p>\n<p>반면 나는 노드에서 익숙하지 않은 코드를 보면 스프링을 보듯이 이해 할 수가 없다.\n같은 백엔드인데도 그렇다.\n인프라도 그렇고… 열심히 하면 어떻게든 되겠지만 참 쉽지않다!!!\n‘노드라서 자스라서 잘 모르겠다’는 말을 하고싶지 않은데 하지 않기가 어렵다.</p>\n<p>그래도 처음에는 노드 + 자스에 손 댈 일이 생길 때 마다 부담되고 고통스러웠는데 지금은 즐겁다.\n디버깅도 즐거워지는 때가 오겠지…</p>\n<p>그리고 프롬프트 엔지니어 얘기가 괜히 나온 게 아니라는 걸 느꼈다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 30%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdklEQVR42j3NO2sUUQDF8f1A1qIBcet8AeuAIGInKcRaJJ1iNtgoaLVIEBUbSWflB3DNusnO7rx2nvfO885N5rV/2UFS/DinOmeUF5osr0nzhqJsCWXDw7cJ+y8F+y8k958Lxs8E9w4F40PJ+GnC3ScJe49T9h6l3D5IuXOQcetBytGHilGa1QipiaUmihVeqJj+zHh3lvP+LOPke8bJt4zJ15zJl4LjzwXHpyWT05I3nxSvporX04qjj4ofv64ZRYlivjCZna+4NDY4rkQVFX3T0dUd27a/0Tc9fbulb6Gue67rjqu6R++y6UhVxyhJNBtPYDsBQZgQhCm2G+FsJKYtMNbhYG3Fg+UqYLH0cEOFG7fYYTMwow4r7hgJUWAYFkvDZf7XYPbngt+zC87nq+HEDySeL/BDOfSNL3DciEgqPNHj7EbjDkvcDCocx8f1KxbrCtO94tLULG1NqXoqvUXpLWX1nwaZ1Vhhhhk1rKOGVbjTDv4BYCCrQ7uOxwwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"빙쳇\"\n        title=\"\"\n        src=\"/static/a882dd5f2516c760b7e5343c51dc983b/37523/bingchat.png\"\n        srcset=\"/static/a882dd5f2516c760b7e5343c51dc983b/e9ff0/bingchat.png 180w,\n/static/a882dd5f2516c760b7e5343c51dc983b/f21e7/bingchat.png 360w,\n/static/a882dd5f2516c760b7e5343c51dc983b/37523/bingchat.png 720w,\n/static/a882dd5f2516c760b7e5343c51dc983b/302a4/bingchat.png 1080w,\n/static/a882dd5f2516c760b7e5343c51dc983b/07a9c/bingchat.png 1440w,\n/static/a882dd5f2516c760b7e5343c51dc983b/8170e/bingchat.png 2132w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>빙챗의 엄청난 검색 능력을 보여주려고 다시 질문했는데 절대 그 때 주었던 리눅스 문서를 주지 않는다.\n로그인 하지 않고 검색했어서 히스토리를 찾을 수가 없는데, 어떻게 검색했었을까?\n내가 했는데도 기억이 안 나서 몹시 안타깝다.</p>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#%EF%B8%8F-%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9\">⚡️ 문제 상황</a></li>\n<li><a href=\"#-eai_again%EC%9D%80-%EC%96%B4%EB%94%94%EC%97%90%EC%84%9C-%EC%98%A4%EB%8A%94%EA%B0%80\">🧶 EAI_AGAIN은 어디에서 오는가</a></li>\n<li><a href=\"#-%EC%9E%98-%ED%95%98%EB%8A%94-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%90%A0-%EC%88%98-%EC%9E%88%EB%82%98%EC%9A%94\">🛶 잘 하는 개발자는 어떻게 될 수 있나요</a></li>\n</ul>\n</div>","excerpt":"⚡️ 문제 상황 언젠가부터 백엔드 서버 배포 직후에 아주 짧은 서비스 순단이 일어났다.  배포 직후 외부 API를 호출 할 때 DNS 조회에 실패하는 걸로 추정되었다.\n여러번 발생하는 에러가 아니기에 다른 팀원이 애플리케이션 실행 후 트래픽 허용 전, 으로 호출하는 모든 도메인을 한 번씩 조회하도록 배포 스크립트를 수정했다.\nDNS 조회 결과를 캐싱할 것으로 기대했기 때문이다. 하지만 조치 후에도 여전히 이라는 동일한 에러 메시지와 함께 순단이 발생했다.\n순단으로 인해 틀어진 여러 정합을 수동으로 맞춰야 하는 상황을 없애기 위해 이번 스프린트에 해결을 목표했다. 🧶 EAI_AGAIN은 어디에서 오는가 이 코드를 누가 언제 왜 던지는가 부터 알기 위해 라이브러리를 포함해 코드를 검색했는데 나오지 않았다.\n그래서 함수 이름으로 추정되는 를 검색해보고, 에러 콜스택도 읽어봤다.  프로젝트 및 노드 모듈 코드 내에 라는 함수는 없었고, 대신 노드 모듈 내의  파일의 주석에 언급이 있었다. …","frontmatter":{"date":"June 04, 2023","title":"배포 중 순단을 없애고 싶었을 뿐인데","categories":"etc CS","author":"써머","emoji":"headers/dns-error-eia-again.png"},"fields":{"slug":"/dns-error-eia-again/"}},"next":{"id":"89c01e28-cb12-5ced-a644-49526626224b","html":"<h2 id=\"-문제상황\" style=\"position:relative;\"><a href=\"#-%EB%AC%B8%EC%A0%9C%EC%83%81%ED%99%A9\" aria-label=\" 문제상황 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🧶 문제상황</h2>\n<p><a href=\"https://hyewoncc.github.io/load-test/\">서버 오픈 전 부하테스트로 대비하기</a>의 경험으로, 요즘 코드를 짤 때 외부 호출이 끼어있다면 트랜잭션을 최소로 잡고 있다.\n거기다 더티 체킹도 사용하지 않고 명시적으로 다시 저장해주는 방식을 사용 중이다. 이건 교휸이 있어서는 아니고, 그냥 성향이다. 더 읽기 명확한 것 같고?</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 28.888888888888886%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA7klEQVR42mWR226DMBBE8///1vahVKnUphVBGBo7mJudgC+nAkpI1JXGHo9Ws/Z4F2NkQgjLHmHjsx5Ya9ViCDNmbeJx69/BQvIq8Cks78eGVHouY2SwA+Ig2b98cEhSTmk1m7ii4PqWoJ6fsMkrQyFuA3fTMlUmFKXUtGagtY7eXjCdIT8WaFVjWovtrjjnqITg5/uLodb4tsH13X9Dqc6UZYlSirbtcM5T65osy1BKLjdzjr7vabRG5DnGmPnJfhweDRcsQvjLczYYPfIkqc4a7wMXc8VauwZ6y/Ihw5VAXKO/Tbuv+/P6eRs2w18Fj9N7fX0PggAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"entity\"\n        title=\"\"\n        src=\"/static/37295abf486de22af73111d2cec6e742/37523/entity.png\"\n        srcset=\"/static/37295abf486de22af73111d2cec6e742/e9ff0/entity.png 180w,\n/static/37295abf486de22af73111d2cec6e742/f21e7/entity.png 360w,\n/static/37295abf486de22af73111d2cec6e742/37523/entity.png 720w,\n/static/37295abf486de22af73111d2cec6e742/302a4/entity.png 1080w,\n/static/37295abf486de22af73111d2cec6e742/07a9c/entity.png 1440w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ItemService</span> <span class=\"token punctuation\">{</span>\n    \n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">UserRepository</span> userRepository<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">UserItemRepository</span> userItemRepository<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ExternalItemClient</span> itemClient<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> userId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Item</span> item<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        itemClient<span class=\"token punctuation\">.</span><span class=\"token function\">checkAvailable</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">User</span> user <span class=\"token operator\">=</span> userRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserNotExistException</span><span class=\"token operator\">::</span><span class=\"token keyword\">new</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        user<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        userItemRepository<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span>user<span class=\"token punctuation\">.</span><span class=\"token function\">getItems</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기에 아이템을 삭제하는 기능을 추가 개발하게 되었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ItemService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> userId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> itemId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        itemClient<span class=\"token punctuation\">.</span><span class=\"token function\">checkExpired</span><span class=\"token punctuation\">(</span>itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        userItemRepository<span class=\"token punctuation\">.</span><span class=\"token function\">deleteByUserIdAndItemId</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">,</span> itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그리고 테스트를 실행하니, 아래와 같은 에러 메시지를 던지며 터졌다.</p>\n<blockquote>\n<p>No EntityManager with actual transaction available for current thread - cannot reliably process ‘remove’ call; nested exception is javax.persistence.TransactionRequiredException: No EntityManager with actual transaction available for current thread - cannot reliably process ‘remove’ call\norg.springframework.dao.InvalidDataAccessApiUsageException: No EntityManager with actual transaction available for current thread - cannot reliably process ‘remove’ call; nested exception is javax.persistence.TransactionRequiredException: No EntityManager with actual transaction available for current thread - cannot reliably process ‘remove’ call</p>\n</blockquote>\n<br>\n<h2 id=\"-transactional-없어도-잘되던데\" style=\"position:relative;\"><a href=\"#-transactional-%EC%97%86%EC%96%B4%EB%8F%84-%EC%9E%98%EB%90%98%EB%8D%98%EB%8D%B0\" aria-label=\" transactional 없어도 잘되던데 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>❓ Transactional 없어도 잘되던데</h2>\n<p>이 에러를 보자마자 스치는 기억이 있었으니…\n팀원에게 코드리뷰를 받다가 <code class=\"language-text\">트랜잭션이 없는데 제대로 동작해? 확인한 거지?</code>라는 얘기를 들었었다.\n그 때 잘 되는데? 트랜잭션이랑 이거랑 관련 없지 않아? 하고 넘어갔는데, 원인은 모르지만 이 얘기였구나! 했다.</p>\n<p>에러 메시지를 검색하면 서비스 메서드에 <code class=\"language-text\">@Transactional</code>을 붙이면 해결된다는 얘기가 많이 나온다.\n붙여보니 잘 된다.\n나도 외부 호출 문제를 겪기 전에는 으레 이렇게 짜곤 했으니, 이런 문제를 겪을 일이 없었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ItemService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> userId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> itemId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        itemClient<span class=\"token punctuation\">.</span><span class=\"token function\">checkExpired</span><span class=\"token punctuation\">(</span>itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        userItemRepository<span class=\"token punctuation\">.</span><span class=\"token function\">deleteByUserIdAndItemId</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">,</span> itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그런데 여기서 이상하다 느낀 게, 서비스에 <code class=\"language-text\">@Transactional</code> 없다고 동작 안하는 게 맞나?\n한 트랜잭션에서 처리하고 싶지 않을 수도 있는데? 하는 거였다.\n그리고 이제까지는 왜 문제가 없었지? 하는 점도 이상했다.</p>\n<p>이유는 금방 찾을 수 있었는데, <code class=\"language-text\">JpaRepository</code>의 구현체인 <code class=\"language-text\">SimpleJpaRepository</code>에서 이미 메서드에 <code class=\"language-text\">@Transactional</code>을 붙여 놓아서다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Repository</span>\n<span class=\"token annotation punctuation\">@Transactional</span><span class=\"token punctuation\">(</span>readOnly <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SimpleJpaRepository</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> ID<span class=\"token punctuation\">></span></span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">JpaRepositoryImplementation</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">T</span><span class=\"token punctuation\">,</span> ID<span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n\t<span class=\"token annotation punctuation\">@Override</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">deleteById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ID</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t<span class=\"token class-name\">Assert</span><span class=\"token punctuation\">.</span><span class=\"token function\">notNull</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">,</span> <span class=\"token constant\">ID_MUST_NOT_BE_NULL</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n\t\t<span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">EmptyResultDataAccessException</span><span class=\"token punctuation\">(</span>\n\t\t\t\t<span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"No %s entity with id %s exists!\"</span><span class=\"token punctuation\">,</span> entityInformation<span class=\"token punctuation\">.</span><span class=\"token function\">getJavaType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그래서 <code class=\"language-text\">JpaRepository</code>에 미리 선언된 메서드를 호출할 경우에, 서비스 클래스에서 <code class=\"language-text\">@Transactional</code>을 붙이지 않아도 문제가 없었던 것이다.\n따라서 레포지토리 클래스에 추가로 정의한 메서드에 <code class=\"language-text\">@Transactional</code>을 붙여줘도 문제를 해결할 수 있다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Repository</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">UserItemRepository</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">JpaRepository</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserItem</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token annotation punctuation\">@Transactional</span>\n    <span class=\"token keyword\">void</span> <span class=\"token function\">deleteByUserIdAndItemId</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> userId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>그러다 직접 사용할 메서드를 선언해야 하는 <code class=\"language-text\">Repository</code> 인터페이스를 상속하면 어떻게 될까 궁금해졌다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">UserItemRepository</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Repository</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">UserItem</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token comment\">// @Transactional이 없는데 동작할까?  </span>\n    <span class=\"token class-name\">UserItem</span> <span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">UserItem</span> userItem<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">void</span> <span class=\"token function\">deleteByUserIdAndItemId</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> userId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 5.555555555555555%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAABCAYAAADeko4lAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAQklEQVR42kXGSwqAMAwFQI8iImJJQj62Dd7/YK+0LlwMzKaREG8oErjZQFohkWDrIGtg7//tu3gu8/q868dF2M+CAdeBHw+Sry07AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"구현체\"\n        title=\"\"\n        src=\"/static/36a1bd768d0328bb18fadf1b4bc01436/37523/simplejparepository.png\"\n        srcset=\"/static/36a1bd768d0328bb18fadf1b4bc01436/e9ff0/simplejparepository.png 180w,\n/static/36a1bd768d0328bb18fadf1b4bc01436/f21e7/simplejparepository.png 360w,\n/static/36a1bd768d0328bb18fadf1b4bc01436/37523/simplejparepository.png 720w,\n/static/36a1bd768d0328bb18fadf1b4bc01436/302a4/simplejparepository.png 1080w,\n/static/36a1bd768d0328bb18fadf1b4bc01436/07a9c/simplejparepository.png 1440w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이 역시 구현체는 <code class=\"language-text\">SimpleJpaRepository</code>로 동일해, 미리 구현되어 있는 메서드는 <code class=\"language-text\">@Transactional</code> 없이도 동작한다.</p>\n<br>\n<h2 id=\"-관성을-이기기\" style=\"position:relative;\"><a href=\"#-%EA%B4%80%EC%84%B1%EC%9D%84-%EC%9D%B4%EA%B8%B0%EA%B8%B0\" aria-label=\" 관성을 이기기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🛺 관성을 이기기</h2>\n<p>JPA 쓴 지가 언젠데 이제까지 이걸 몰랐을까? 자문했을 때, 일하면서 기출변형같은 문제를 마주쳐서 그런 것 같다.\n<a href=\"https://hyewoncc.github.io/fetch-join-and-entity-graph/\">실종된 데이터와 연관 객체 조회하기</a> 포스팅도 그랬다.\n보통 JPA를 쓰면 서비스 클래스에 <code class=\"language-text\">@Transactional</code>부터 붙이고 시작하니까 이런 식의 오류를 마주칠 일이 적다.\n이런 문제를 해결할 때 왜 나는 좀 더 꼼꼼히 공부하지 않았을까? 자책했는데, 요즘은 해결하면서 배워가면 충분한 거 아닌가? 로 생각이 조금 바뀌었다.</p>\n<p>처음 JPA를 접하면서 지금 수준까지 일단 파보려고 했다면 개발을 재밌게 공부할 수 있었을까? 재미야 둘째쳐도, 효율적으로 공부할 수 있었을까?\n요즘 익숙한 스프링보다 낯선 Node.js의 오류와 싸우는 시간이 길어서 이런 생각이 더 드는 것 같기도 하다.\n자바스크립트랑 Node를 마스터하고 해결해야지 하면 아직 오류 하나도 제대로 못고쳤을지 모른다.\n앞으로 수많은 이걸 왜 몰랐지를 마주칠텐데, 그 때 마다 스트레스 받을 필요가 없다.</p>\n<p>또 다른 생각은 관성을 이기자는 것이다. 매번 다짐하는데 잘 안되는 걸 보면, 내가 관성에 약한 편인 것 같다.\n이 문제를 금방 해결할 수 있었던 건, 팀원이 말했던 <code class=\"language-text\">트랜잭션이 없는데 제대로 동작하냐</code>는 리뷰 덕분이었다.\n그 때도 난 잘 되던데 하고 그냥 넘어갔었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAT4txCyJP//EABkQAQADAQEAAAAAAAAAAAAAAAEAAhEDEP/aAAgBAQABBQJW0dvAyc/f/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAEQITH/2gAIAQEABj8C4YjY5//EABoQAQEAAwEBAAAAAAAAAAAAAAEAESFRMdH/2gAIAQEAAT8hMOYa8icJggRG+7xws7b/2gAMAwEAAgADAAAAEHc//8QAFhEBAQEAAAAAAAAAAAAAAAAAAQAR/9oACAEDAQE/EBwm/8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8Qiv/EABwQAQACAwADAAAAAAAAAAAAAAEAESFBUTGBwf/aAAgBAQABPxAP6gvBvxNoM2ZQ9rURIQR1Ego03ke4BUBbmiKM+/k//9k='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"난 이렇게 살아왔는데\"\n        title=\"\"\n        src=\"/static/fdaa77e4845fff6789187e56a5c2ec98/80e3c/livethisway.jpg\"\n        srcset=\"/static/fdaa77e4845fff6789187e56a5c2ec98/4ec73/livethisway.jpg 180w,\n/static/fdaa77e4845fff6789187e56a5c2ec98/158ba/livethisway.jpg 360w,\n/static/fdaa77e4845fff6789187e56a5c2ec98/80e3c/livethisway.jpg 720w,\n/static/fdaa77e4845fff6789187e56a5c2ec98/47311/livethisway.jpg 1080w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div style=\"text-align:center; font-style:italic; color:grey;\">\n  이런 상태가 될 때가 종종 있다 \n</div>\n<br>\n<p>허투루 지나가지 않고 왜 제대로 동작하지 않을 것 같냐고 물어봤다면 더 빨리 배울 수 있었다.\n하던 대로 하지않고 절박한 마음으로 일하고 공부하는 그런 열정을 가질 수 있도록… 의식적으로 노력해야겠다.\n말만 썼는데 벌써 쉽지 않다.</p>\n<p>그리고 위에서 문제가 되었던 <code class=\"language-text\">deleteByUserIdAndItemId()</code>는 결국 요구사항에 맞춰 소프트 딜리트로 바뀌면서 자연스레 해결됐다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ItemService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> userId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> itemId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        itemClient<span class=\"token punctuation\">.</span><span class=\"token function\">checkExpired</span><span class=\"token punctuation\">(</span>itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">UserItems</span> userItems <span class=\"token operator\">=</span> <span class=\"token class-name\">UserItems</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>userItemRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findAllByUserId</span><span class=\"token punctuation\">(</span>userId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        userItems<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span>itemId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n        userItemRepository<span class=\"token punctuation\">.</span><span class=\"token function\">saveAll</span><span class=\"token punctuation\">(</span>userItems<span class=\"token punctuation\">.</span><span class=\"token function\">getUserItems</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br>\n<p>원래 소프트 딜리트로 만들었어야 할 로직인데, 옆길로 새서 좋은 걸 배웠다.</p>\n<br>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EB%AC%B8%EC%A0%9C%EC%83%81%ED%99%A9\">🧶 문제상황</a></li>\n<li><a href=\"#-transactional-%EC%97%86%EC%96%B4%EB%8F%84-%EC%9E%98%EB%90%98%EB%8D%98%EB%8D%B0\">❓ Transactional 없어도 잘되던데</a></li>\n<li><a href=\"#-%EA%B4%80%EC%84%B1%EC%9D%84-%EC%9D%B4%EA%B8%B0%EA%B8%B0\">🛺 관성을 이기기</a></li>\n</ul>\n</div>","frontmatter":{"date":"May 07, 2023","title":"[JPA] @Transactional이 없다고 레포지토리가 왜 터져?","categories":"JPA 트러블슈팅","author":"써머","emoji":"headers/jpa-transactional.png"},"fields":{"slug":"/jpa-transactional/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://hyewoncc.github.io","comments":{"utterances":{"repo":"hyewoncc/hyewoncc.github.io"}}}}},"pageContext":{"slug":"/dns-error-eia-again/","nextSlug":"/jpa-transactional/","prevSlug":""}},"staticQueryHashes":["1073350324","1956554647","2938748437","3350743975"],"slicesMap":{}}